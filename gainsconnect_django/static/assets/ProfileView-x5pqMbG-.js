import{P as v,H as w,u as b,r as p,o as x,a as i,c as t,b as r,t as u,d as k,F as N,e as $,f as P,g as I,h as o,i as B,_ as E,j as S}from"./index-C-M45ECf.js";const A={class:"w-full bg-gray-900 min-h-screen"},F={key:0,class:"max-w-3xl mx-auto grid grid-cols-1 gap-6"},D={class:"flex justify-center items-center flex-col"},C=["src"],R={class:"font-bold text-2xl"},V={key:0},j={key:1,disabled:"",class:"py-2 px-4 bg-purple-700 text-white rounded-lg mr-2 opacity-50"},z={key:0},G={key:1},L={key:1,class:"flex items-center justify-center min-h-screen"},U={__name:"ProfileView",props:["id"],setup(f){new v,new w;const h=f,l=b(),s=p(),a=p(),d=p([]),n=encodeURIComponent(h.id);h.id.split("/").pop(),x(async()=>{try{console.log("fetching author data");const e=await i.get(`/api/authors/${n}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});s.value=e.data}catch(e){throw console.log("Error fetching profile"),e}if(l.isAuthenticated){console.log("fetching follow relation");try{const e=await i.get(`/api/authors/${l.uid}/followers/${n}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});a.value=e.data}catch(e){console.log("Did not find follow relation"),a.value=e.response.data}}_()});const y=async()=>{try{await I(l.uid,s.value),a.value="PENDING"}catch(e){console.log("Error sending follow request",e)}},m=async()=>{try{const e=await i.delete(`/api/authors/${l.uid}/followers/${n}`);e.status>=200&&e.status<300&&(a.value="NONE")}catch(e){throw console.log("Error unfollowing author"),e}},_=async()=>{console.log("fetching posts");try{const e=await i.get(`/api/authors/${n}/posts/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});d.value=e.data.src,console.log("posts",e.data)}catch(e){console.error("Failed to load posts:",e)}};return(e,c)=>(o(),t("main",A,[s.value?(o(),t("div",F,[r("div",D,[r("img",{src:s.value.profileImage,class:"rounded w-40 h-40 items-center"},null,8,C),r("p",R,u(s.value.displayName),1),a.value?(o(),t("div",V,[a.value==="FOLLOWING"||a.value==="FRIENDS"?(o(),t("button",{key:0,onClick:m,class:"py-2 px-4 bg-gray-900 text-white rounded-lg mr-2 opacity-75 border border-gray-600"},"Unfollow")):a.value==="PENDING"?(o(),t("button",j,"Pending")):(o(),t("button",{key:2,onClick:y,class:"py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-500 mr-2"},"Follow"))])):k("",!0),r("p",null," Biography: "+u(s.value.biography),1),r("p",null," github: "+u(s.value.github),1),r("p",null," host: "+u(s.value.host),1)]),c[1]||(c[1]=r("h2",{class:"text-3xl font-bold border-b-2 border-gray-600 pb-2 text-center"},"Public Posts",-1)),d.value.length>0?(o(),t("div",z,[(o(!0),t(N,null,$(d.value,g=>(o(),B(E,{key:g.id,post:g,class:"mt-5"},null,8,["post"]))),128))])):(o(),t("div",G,c[0]||(c[0]=[r("p",null,"Author has no public posts available.",-1)])))])):(o(),t("div",L,[P(S,{class:"-ml-4"})]))]))}};export{U as default};
